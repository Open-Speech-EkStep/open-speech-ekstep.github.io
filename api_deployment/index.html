<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create ASR using Wav2vec"><meta name=author content=Ekstep><link href=https://open-speech-ekstep.github.io/api_deployment/ rel=canonical><link rel=icon href=../assets/favicon.png><meta name=generator content="mkdocs-1.3.0, mkdocs-material-7.0.6"><title>API Deployment Guide - Vakyansh</title><link rel=stylesheet href=../assets/stylesheets/main.7a40789f.min.css><link rel=stylesheet href=../assets/stylesheets/palette.7fa14f5b.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","None","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#asr-and-tts-api-deployment-guide class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Vakyansh class="md-header__button md-logo" aria-label=Vakyansh data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Vakyansh </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> API Deployment Guide </span> </div> </div> </div> <div class=md-header__options> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Open-Speech-EkStep title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> Open-Speech-EkStep </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../data_collection/ class="md-tabs__link md-tabs__link--active"> Developer Guides </a> </li> <li class=md-tabs__item> <a href=../CONTRIBUTING/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Vakyansh class="md-nav__button md-logo" aria-label=Vakyansh data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> Vakyansh </label> <div class=md-nav__source> <a href=https://github.com/Open-Speech-EkStep title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> Open-Speech-EkStep </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Developer Guides <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Developer Guides" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Developer Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data_collection/ class=md-nav__link> Data Collection Pipeine </a> </li> <li class=md-nav__item> <a href=../intelligent_data_pipelines/ class=md-nav__link> Intelligent Data Pipeline </a> </li> <li class=md-nav__item> <a href=../ulca_pipeline/ class=md-nav__link> ULCA Pipeline </a> </li> <li class=md-nav__item> <a href=../model_training/ class=md-nav__link> Model Training Pipeline </a> </li> <li class=md-nav__item> <a href=../crowdsource_platform/ class=md-nav__link> Crowdsourcing Platform </a> </li> <li class=md-nav__item> <a href=../adr/ class=md-nav__link> Architecture Decision Records </a> </li> <li class=md-nav__item> <a href=../speaker_clustering/ class=md-nav__link> Speaker Clustering </a> </li> <li class=md-nav__item> <a href=../gender_identification/ class=md-nav__link> Gender Identification </a> </li> <li class=md-nav__item> <a href=../language_identification/ class=md-nav__link> Language Identification </a> </li> <li class=md-nav__item> <a href=../punctuation_model_training/ class=md-nav__link> Punctation Model Training </a> </li> <li class=md-nav__item> <a href=../inverse_text_normalization/ class=md-nav__link> Inverse Text Normalization </a> </li> <li class=md-nav__item> <a href=../asr_model_api/ class=md-nav__link> Speech Recognititon Model API </a> </li> <li class=md-nav__item> <a href=../asr_streaming_service/ class=md-nav__link> Speech Recognititon Streaming API </a> </li> <li class=md-nav__item> <a href=../tts_model_training/ class=md-nav__link> Text To Speech Model training </a> </li> <li class=md-nav__item> <a href=../tts_model_api/ class=md-nav__link> Text To Speech Model API </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> API Deployment Guide <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> API Deployment Guide </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#automatic-speech-recognitionasr class=md-nav__link> AUTOMATIC SPEECH RECOGNITION(ASR) </a> <nav class=md-nav aria-label="AUTOMATIC SPEECH RECOGNITION(ASR)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=#artifacts class=md-nav__link> Artifacts </a> </li> <li class=md-nav__item> <a href=#infrastructure-requirements class=md-nav__link> Infrastructure Requirements </a> </li> <li class=md-nav__item> <a href=#deployment-components-and-steps class=md-nav__link> Deployment components and steps </a> </li> <li class=md-nav__item> <a href=#api-for-cdac class=md-nav__link> API for CDAC: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#text-to-speech-servicetts class=md-nav__link> TEXT TO SPEECH SERVICE(TTS): </a> <nav class=md-nav aria-label="TEXT TO SPEECH SERVICE(TTS):"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture_1 class=md-nav__link> Architecture: </a> </li> <li class=md-nav__item> <a href=#artifacts_1 class=md-nav__link> Artifacts: </a> </li> <li class=md-nav__item> <a href=#infrastructure-requirements_1 class=md-nav__link> Infrastructure Requirements: </a> </li> <li class=md-nav__item> <a href=#deployment-components-and-steps_1 class=md-nav__link> Deployment components and steps: </a> </li> <li class=md-nav__item> <a href=#api-for-cdac_1 class=md-nav__link> API for CDAC: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#contributing class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> <li class=md-nav__item> <a href=#git-repository class=md-nav__link> Git repository </a> </li> <li class=md-nav__item> <a href=#contact class=md-nav__link> Contact </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> About <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=About data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../CONTRIBUTING/ class=md-nav__link> Contributions </a> </li> <li class=md-nav__item> <a href=../RELEASE_NOTES/ class=md-nav__link> Release notes </a> </li> <li class=md-nav__item> <a href=../LICENSE class=md-nav__link> License </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#automatic-speech-recognitionasr class=md-nav__link> AUTOMATIC SPEECH RECOGNITION(ASR) </a> <nav class=md-nav aria-label="AUTOMATIC SPEECH RECOGNITION(ASR)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture class=md-nav__link> Architecture </a> </li> <li class=md-nav__item> <a href=#artifacts class=md-nav__link> Artifacts </a> </li> <li class=md-nav__item> <a href=#infrastructure-requirements class=md-nav__link> Infrastructure Requirements </a> </li> <li class=md-nav__item> <a href=#deployment-components-and-steps class=md-nav__link> Deployment components and steps </a> </li> <li class=md-nav__item> <a href=#api-for-cdac class=md-nav__link> API for CDAC: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#text-to-speech-servicetts class=md-nav__link> TEXT TO SPEECH SERVICE(TTS): </a> <nav class=md-nav aria-label="TEXT TO SPEECH SERVICE(TTS):"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#architecture_1 class=md-nav__link> Architecture: </a> </li> <li class=md-nav__item> <a href=#artifacts_1 class=md-nav__link> Artifacts: </a> </li> <li class=md-nav__item> <a href=#infrastructure-requirements_1 class=md-nav__link> Infrastructure Requirements: </a> </li> <li class=md-nav__item> <a href=#deployment-components-and-steps_1 class=md-nav__link> Deployment components and steps: </a> </li> <li class=md-nav__item> <a href=#api-for-cdac_1 class=md-nav__link> API for CDAC: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#contributing class=md-nav__link> Contributing </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> License </a> </li> <li class=md-nav__item> <a href=#git-repository class=md-nav__link> Git repository </a> </li> <li class=md-nav__item> <a href=#contact class=md-nav__link> Contact </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=asr-and-tts-api-deployment-guide>ASR and TTS API Deployment Guide<a class=headerlink href=#asr-and-tts-api-deployment-guide title="Permanent link">&para;</a></h1> <p>We have developed two services for deployment in the CDAC Kubernetes environment. The services are: 1) ASR 2) TTS</p> <!-- ABOUT THE PROJECT --> <h2 id=automatic-speech-recognitionasr>AUTOMATIC SPEECH RECOGNITION(ASR)<a class=headerlink href=#automatic-speech-recognitionasr title="Permanent link">&para;</a></h2> <p>Our speech-to-text interface enables us to accurately convert speech into text using an API powered by deep learning neural network algorithms for automatic speech recognition (ASR) in Indic languages. This service also enables us to infer in a batch mode over REST protocol to transcribe speech audio files. This also has a streaming service that provides an interface to accept chunks of the continuous audio stream that can be transcribed in real-time to text.</p> <h3 id=architecture>Architecture<a class=headerlink href=#architecture title="Permanent link">&para;</a></h3> <p>The architecture for ASR service with both batch and real-time mode is shown here. </p> <p><img alt=Screenshot src=../img/streaming-service.jpg> </p> <div align=center> Fig 1 </div> <h3 id=artifacts>Artifacts<a class=headerlink href=#artifacts title="Permanent link">&para;</a></h3> <p>The latest image for the ASR service can be found at <code>gcr.io/ekstepspeechrecognition/speech_recognition_model_api:&lt;version&gt;</code></p> <p>The code repository for the ASR API service can be found at <a href=https://github.com/Open-Speech-EkStep/speech-recognition-open-api>https://github.com/Open-Speech-EkStep/speech-recognition-open-api</a></p> <p>The deployment infra code repository for the ASR API service can be found at <a href=https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra>https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra</a></p> <h3 id=infrastructure-requirements>Infrastructure Requirements<a class=headerlink href=#infrastructure-requirements title="Permanent link">&para;</a></h3> <p>1.A fully operational Kubernetes cluster with at least 3 nodes, each containing at least 8CPUs 64Gb RAM and 1 Tesla T4 GPU of 16GB. This is a basic requirement to support 50-100 concurrent users at ease. For higher user support, better GPU configurations are highly recommended.</p> <p>2.A mountable disk or network drive of at least 50GB to store the models and artifacts for ASR. This disk/drive should be part of the same zone as the K8 cluster so it can be easily mounted to the Kubernetes pods.</p> <p>3.The cluster should be publicly accessible using an IP exposed by the load balancer.</p> <p>4.Jenkins can be set up optionally as a deployment pipeline of CI/CD and configured with the infra code repository.</p> <h3 id=deployment-components-and-steps>Deployment components and steps<a class=headerlink href=#deployment-components-and-steps title="Permanent link">&para;</a></h3> <p>The various components or modules as shown in the above Fig 1 are required to be installed in a package for the service to work successfully.</p> <p><strong>Loading models files and artifacts</strong>: The first step towards deployment is dumping the model files for every language into their respective language directories and placing them inside the external mountable disk at a designated location. Once the models are placed, create a file named ‘model_dict.json’ in the same hierarchy as the language directories. The model_dict.json should have the respective paths of the language model files and the setting for ITN and punctuation for every language. The ASR models for every languauge can be downloaded from ​​<a href=https://storage.googleapis.com/asr-public-models/data-sources-deployment/ >https://storage.googleapis.com/asr-public-models/data-sources-deployment/</a>. ITN and punctuation models are downloaded automatically from the buckets,so not needed to be placed manually.</p> <p>Sample model_dict.json <div class=highlight><pre><span></span><code><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=nt>&quot;en&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/indian_english/final_model.pt&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enablePunctuation&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enableITN&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>
<span class=w>    </span><span class=nt>&quot;hi&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/hindi/hindi.pt&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enablePunctuation&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enableITN&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>
<span class=w>    </span><span class=nt>&quot;ta&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;path&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/tamil/final_model.pt&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enablePunctuation&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;enableITN&quot;</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> The models from the external volume needs to be mounted at <code>/opt/text_to_speech_open_api/deployed_models/</code> inside the pod. The volume mounts are specified in <a href=https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra>https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra</a></p> <p><strong>Ngnix</strong>: A NGNIX router should be deployed and be publicly exposed as a load balancer service. The ngnix conf file should be updated with proper location blocks to support asr and punctuate endpoints. Sample ngnix.conf</p> <p><div class=highlight><pre><span></span><code><span class=err>server</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=err>server_</span><span class=kc>na</span><span class=err>me</span><span class=w>  </span><span class=err>&lt;server</span><span class=mi>-</span><span class=kc>na</span><span class=err>me&gt;;</span><span class=w></span>
<span class=w>    </span><span class=err>lis</span><span class=kc>ten</span><span class=w> </span><span class=mi>443</span><span class=w> </span><span class=err>ssl</span><span class=w> </span><span class=err>de</span><span class=kc>fault</span><span class=w> </span><span class=err>h</span><span class=kc>tt</span><span class=err>p</span><span class=mi>2</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>lis</span><span class=kc>ten</span><span class=w> </span><span class=p>[::]:</span><span class=mi>443</span><span class=w> </span><span class=err>ssl</span><span class=w> </span><span class=err>de</span><span class=kc>fault</span><span class=w> </span><span class=err>h</span><span class=kc>tt</span><span class=err>p</span><span class=mi>2</span><span class=w> </span><span class=err>ipv</span><span class=mi>6</span><span class=err>o</span><span class=kc>nl</span><span class=err>y=o</span><span class=kc>n</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>ssl_cer</span><span class=kc>t</span><span class=err>i</span><span class=kc>f</span><span class=err>ica</span><span class=kc>te</span><span class=w>    </span><span class=err>/e</span><span class=kc>t</span><span class=err>c/ssl/ulcaco</span><span class=kc>ntr</span><span class=err>ib_ssl.cr</span><span class=kc>t</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>ssl_cer</span><span class=kc>t</span><span class=err>i</span><span class=kc>f</span><span class=err>ica</span><span class=kc>te</span><span class=err>_key</span><span class=w>    </span><span class=err>/e</span><span class=kc>t</span><span class=err>c/ssl/ulcaco</span><span class=kc>ntr</span><span class=err>ib_ssl.key;</span><span class=w></span>
<span class=w>    </span><span class=err>resolver</span><span class=w> </span><span class=mf>127.0.0.11</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>u</span><span class=kc>n</span><span class=err>derscores_i</span><span class=kc>n</span><span class=err>_headers</span><span class=w> </span><span class=err>o</span><span class=kc>n</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>clie</span><span class=kc>nt</span><span class=err>_max_body_size</span><span class=w> </span><span class=mi>10</span><span class=err>M;</span><span class=w></span>
<span class=w>    </span><span class=err>clie</span><span class=kc>nt</span><span class=err>_header_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w> </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>clie</span><span class=kc>nt</span><span class=err>_body_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w> </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=kc>fast</span><span class=err>cgi_read_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w> </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>proxy_co</span><span class=kc>nne</span><span class=err>c</span><span class=kc>t</span><span class=err>_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w>       </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>proxy_se</span><span class=kc>n</span><span class=err>d_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w>          </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>proxy_read_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w>          </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>se</span><span class=kc>n</span><span class=err>d_</span><span class=kc>t</span><span class=err>imeou</span><span class=kc>t</span><span class=w>                </span><span class=mi>600</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip</span><span class=w> </span><span class=err>o</span><span class=kc>n</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_proxied</span><span class=w> </span><span class=err>a</span><span class=kc>n</span><span class=err>y;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_</span><span class=kc>t</span><span class=err>ypes</span><span class=w> </span><span class=kc>te</span><span class=err>x</span><span class=kc>t</span><span class=err>/plai</span><span class=kc>n</span><span class=w> </span><span class=kc>te</span><span class=err>x</span><span class=kc>t</span><span class=err>/xml</span><span class=w> </span><span class=kc>te</span><span class=err>x</span><span class=kc>t</span><span class=err>/css</span><span class=w> </span><span class=err>applica</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=err>/jso</span><span class=kc>n</span><span class=w> </span><span class=err>applica</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=err>/x</span><span class=mi>-</span><span class=err>javascrip</span><span class=kc>t</span><span class=w> </span><span class=kc>te</span><span class=err>x</span><span class=kc>t</span><span class=err>/javascrip</span><span class=kc>t</span><span class=w> </span><span class=err>applica</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=err>/javascrip</span><span class=kc>t</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_vary</span><span class=w> </span><span class=err>o</span><span class=kc>n</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_disable</span><span class=w> </span><span class=s2>&quot;MSIE [1-6]\.(?!.*SV1)&quot;</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_comp_level</span><span class=w> </span><span class=mi>6</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_bu</span><span class=kc>ffers</span><span class=w> </span><span class=mi>16</span><span class=w> </span><span class=mi>8</span><span class=err>k;</span><span class=w></span>
<span class=w>    </span><span class=err>gzip_mi</span><span class=kc>n</span><span class=err>_le</span><span class=kc>n</span><span class=err>g</span><span class=kc>t</span><span class=err>h</span><span class=w> </span><span class=mi>512</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=err>add_header</span><span class=w> </span><span class=err>Access</span><span class=mi>-</span><span class=err>Co</span><span class=kc>ntr</span><span class=err>ol</span><span class=mi>-</span><span class=err>Allow</span><span class=mi>-</span><span class=err>Origi</span><span class=kc>n</span><span class=w> </span><span class=err>*</span><span class=w> </span><span class=err>always;</span><span class=w></span>
<span class=w>    </span><span class=err>add_header</span><span class=w> </span><span class=err>Access</span><span class=mi>-</span><span class=err>Co</span><span class=kc>ntr</span><span class=err>ol</span><span class=mi>-</span><span class=err>Allow</span><span class=mi>-</span><span class=err>Headers</span><span class=w> </span><span class=err>*</span><span class=w> </span><span class=err>always;</span><span class=w></span>

<span class=w>    </span><span class=err>loca</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=err>/asr</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=err>resolver</span><span class=w> </span><span class=mf>127.0.0.11</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>re</span><span class=kc>turn</span><span class=w> </span><span class=mi>302</span><span class=w> </span><span class=err>/asr/;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=err>loca</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=err>/asr/</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=err>resolver</span><span class=w> </span><span class=mf>127.0.0.11</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_pass</span><span class=w>  </span><span class=err>h</span><span class=kc>tt</span><span class=err>p</span><span class=p>:</span><span class=err>//asr</span><span class=mi>-</span><span class=err>model</span><span class=mi>-</span><span class=err>v</span><span class=mf>2-e</span><span class=kc>n</span><span class=err>voy/;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_h</span><span class=kc>tt</span><span class=err>p_versio</span><span class=kc>n</span><span class=w> </span><span class=mf>1.1</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Upgrade</span><span class=w> </span><span class=err>$h</span><span class=kc>tt</span><span class=err>p_upgrade;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Co</span><span class=kc>nne</span><span class=err>c</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=s2>&quot;Upgrade&quot;</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Hos</span><span class=kc>t</span><span class=w> </span><span class=err>$hos</span><span class=kc>t</span><span class=err>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=err>loca</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=err>/socke</span><span class=kc>t</span><span class=err>.io/</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Upgrade</span><span class=w> </span><span class=err>$h</span><span class=kc>tt</span><span class=err>p_upgrade;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Co</span><span class=kc>nne</span><span class=err>c</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=s2>&quot;upgrade&quot;</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_h</span><span class=kc>tt</span><span class=err>p_versio</span><span class=kc>n</span><span class=w> </span><span class=mf>1.1</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>X</span><span class=mi>-</span><span class=err>Forwarded</span><span class=mi>-</span><span class=err>For</span><span class=w> </span><span class=err>$proxy_add_x_</span><span class=kc>f</span><span class=err>orwarded_</span><span class=kc>f</span><span class=err>or;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_se</span><span class=kc>t</span><span class=err>_header</span><span class=w> </span><span class=err>Hos</span><span class=kc>t</span><span class=w> </span><span class=err>$hos</span><span class=kc>t</span><span class=err>;</span><span class=w></span>
<span class=w>        </span><span class=err>proxy_pass</span><span class=w> </span><span class=err>h</span><span class=kc>tt</span><span class=err>p</span><span class=p>:</span><span class=err>//asr</span><span class=mi>-</span><span class=err>model</span><span class=mi>-</span><span class=err>v</span><span class=mi>2-</span><span class=err>proxy</span><span class=mi>-</span><span class=err>server</span><span class=p>:</span><span class=mi>9009</span><span class=err>/socke</span><span class=kc>t</span><span class=err>.io/;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=err>server</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>  </span><span class=err>server_</span><span class=kc>na</span><span class=err>me</span><span class=w> </span><span class=err>localhos</span><span class=kc>t</span><span class=err>;</span><span class=w></span>
<span class=w>  </span><span class=err>resolver</span><span class=w> </span><span class=mf>127.0.0.11</span><span class=err>;</span><span class=w></span>
<span class=w>  </span><span class=err>lis</span><span class=kc>ten</span><span class=w> </span><span class=mi>50051</span><span class=w> </span><span class=err>h</span><span class=kc>tt</span><span class=err>p</span><span class=mi>2</span><span class=err>;</span><span class=w></span>
<span class=w>  </span><span class=err>loca</span><span class=kc>t</span><span class=err>io</span><span class=kc>n</span><span class=w> </span><span class=err>/</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=err>grpc_pass</span><span class=w> </span><span class=err>grpc</span><span class=p>:</span><span class=err>//asr</span><span class=mi>-</span><span class=err>model</span><span class=mi>-</span><span class=err>v</span><span class=mf>2-e</span><span class=kc>n</span><span class=err>voy;</span><span class=w></span>
<span class=w>  </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> Ngnix is a manual deployment by the infra team and used as a common component for all services.</p> <p><strong>Streaming Proxy</strong>: This is an important component for the streaming service to work with Socket.io connections from the browser clients. The proxy is deployed automatically as part of the deployment package with envoy and ASR service. No explicit install are required.</p> <p><strong>Envoy</strong>: This is a transcoder that helps to convert REST calls from the batch API to GRPC calls to the API. All GRPC and REST connections have to pass through the envoy before it reaches the ASR API servers.</p> <p><strong>Model API server</strong>: The model API server for every language or cluster of languages is deployed as separate pods in the cluster. The language clusters and node accelerators can be configured in the file app_config.yaml. The volume paths can also be correctly configured in the deployment.yaml files and values.yaml files. These files post changes can be committed to the repo, <a href=https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra/tree/cdac-deploy>https://github.com/Open-Speech-EkStep/speech-recognition-open-api-infra/tree/cdac-deploy</a></p> <p>The deployment for proxy, envoy and API server language pods can be configured using Jenkins or can be triggered manually by running the below command in a bastion/window node of CDAC. All three components can be deployed at once. <code>python3 deploy.py --namespace &lt;kubernetes namespace&gt; --api-updated True --image-name gcr.io/ekstepspeechrecognition/speech_recognition_model_api --image-version &lt;latest image version&gt;</code></p> <p>With the successful deployment of components, the pods and services should get spawned for proxy, envoy, and language APIs.</p> <h3 id=api-for-cdac>API for CDAC:<a class=headerlink href=#api-for-cdac title="Permanent link">&para;</a></h3> <p>The REST API endpoint can be accessible for POST requests <code>https://cdac.ulcacontrib.org/asr/v1/recognize/&lt;language_code&gt;</code> For streaming from browser, Client SDK can be used for accessing ASR models. <code>https://github.com/Open-Speech-EkStep/speech-recognition-open-api-client</code></p> <h2 id=text-to-speech-servicetts>TEXT TO SPEECH SERVICE(TTS):<a class=headerlink href=#text-to-speech-servicetts title="Permanent link">&para;</a></h2> <p>Text To Speech (TTS), also known as Speech Synthesis, is a process where text is converted into a human-sounding voice. TTS has been a popular choice for developers and business users alike when building IVR (Interactive Voice Response) solutions and other voice applications, as it accelerates time to production without having to record audio files with human voices. Using recorded files requires recording each message with a human voice, whereas TTS prompts can be dynamically generated from raw text. Our TTS service can enable us to generate life-like speech synthesis in both male and female voices for an array of Indic languages like Hindi, Tamil, Malayalam,Kannada, and many more.</p> <h3 id=architecture_1>Architecture:<a class=headerlink href=#architecture_1 title="Permanent link">&para;</a></h3> <p>The architecture for TTS service is shown here. This service only supports batch inference from REST clients via POST requests. The response returned by the API contains an audio bytes payload for successful inference.</p> <p><img alt=Screenshot src=../img/tts_api.png> </p> <div align=center> Fig 2 </div> <h3 id=artifacts_1>Artifacts:<a class=headerlink href=#artifacts_1 title="Permanent link">&para;</a></h3> <p>The latest image for the TTS service can be found at <code>gcr.io/ekstepspeechrecognition/text_to_speech_open_api:&lt;version&gt;</code></p> <p>The code repository for the TTS API service can be found at <code>https://github.com/Open-Speech-EkStep/text-to-speech-open-api</code></p> <p>The deployment infra code repository for the TTS API service can be found at <code>https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra</code></p> <h3 id=infrastructure-requirements_1>Infrastructure Requirements:<a class=headerlink href=#infrastructure-requirements_1 title="Permanent link">&para;</a></h3> <p>A fully operational Kubernetes cluster with at least 3 nodes, each containing at least 8CPUs 64Gb RAM and 1 Tesla T4 GPU of 16GB. This is a basic requirement to support 50-100 concurrent users at ease. For higher user support, better GPU configurations are highly recommended.</p> <p>A mountable disk or network drive of at least 50GB to store the models and artifacts for TTS. This disk/drive should be part of the same zone as the K8 cluster so it can be easily mounted to the Kubernetes pods.</p> <p>The cluster should be publicly accessible using an IP exposed by the load balancer.</p> <p>Jenkins can be set up optionally as a deployment pipeline of CI/CD and configured with the infra code repository.</p> <h3 id=deployment-components-and-steps_1>Deployment components and steps:<a class=headerlink href=#deployment-components-and-steps_1 title="Permanent link">&para;</a></h3> <p>The various components or modules as shown in the above Fig 1 are required to be installed in a package for the service to work successfully.</p> <p><strong>Loading models files and artifacts</strong>: The first step towards deployment is dumping the model files for every language into their respective language directories and placing them inside the external mountable disk at a designated location. Here for TTS we have TTS models and transliteration models to be placed in the respective directories. Refer readme for directory structure <code>https://github.com/Open-Speech-EkStep/text-to-speech-open-api</code>.</p> <p><strong>TTS MODELS</strong>:Once the tts models are downloaded from <code>https://storage.googleapis.com/vakyaansh-open-models/tts-models/</code>, create a file named <code>model_dict.json</code> in the same hierarchy as the language directories. The model_dict.json should have the respective paths of the language model files and the setting for ITN and punctuation for every language.</p> <p>Sample model_dict.json <div class=highlight><pre><span></span><code><span class=p>{</span><span class=w></span>
<span class=nt>&quot;hi&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=nt>&quot;male_glow&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/male/glow_tts&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;male_hifi&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/male/hifi_tts&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;female_glow&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/female/glow_tts&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;female_hifi&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/female/hifi_tts&quot;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> <strong>TRANSLITERATION MODELS</strong>:The transliteration models aren’t required to be downloaded and placed manually for the first time. But the file named ‘default_lineup.json’ needs to be placed in the directory named ‘translit_models’ in the external volume.This helps to get the models downloaded for the first time. The contents of the default_lineup.json should be: <div class=highlight><pre><span></span><code><span class=p>{</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;bn&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Bengali - বাংলা&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bengali&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bengali/bn_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bengali/bn_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;bengali/bn_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;gu&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Gujarati - ગુજરાતી&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;gujarati&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;gujarati/gu_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;gujarati/gu_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;gujarati/gu_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;hi&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Hindi - हिंदी&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/hi_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/hi_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hindi/hi_111_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;kn&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Kannada - ಕನ್ನಡ&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;kannada&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;kannada/kn_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;kannada/kn_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;kannada/kn_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;gom&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Konkani (Goan) - कोंकणी&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;konkani&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;konkani/gom_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;konkani/gom_words_subset.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;konkani/gom_122_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;mai&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Maithili - मैथिली&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;maithili&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;maithili/mai_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;maithili/mai_words_subset.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;maithili/mai_122_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>


<span class=w>    </span><span class=nt>&quot;ml&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Malayalam - മലയാളം&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;malayalam&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;malayalam/ml_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;malayalam/ml_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;malayalam/ml_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;mr&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Marathi - मराठी&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;marathi&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;marathi/mr_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;marathi/mr_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;marathi/mr_102_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;pa&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Panjabi - ਪੰਜਾਬੀ&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;panjabi&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;panjabi/pa_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;panjabi/pa_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;panjabi/pa_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;sd&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Sindhi - سنڌي‎&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sindhi&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sindhi/sd_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sindhi/sd_words_ccset.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sindhi/sd_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;si&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Sinhala - සිංහල&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sinhala&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sinhala/si_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sinhala/si_words_ccset.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;sinhala/si_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;ta&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Tamil - தமிழ்&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tamil&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tamil/ta_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tamil/ta_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;tamil/ta_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;te&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Telugu - తెలుగు&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;telugu&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;telugu/te_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;telugu/te_words_a4b.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;telugu/te_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>},</span><span class=w></span>

<span class=w>    </span><span class=nt>&quot;ur&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;name&quot;</span><span class=w>    </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Urdu - اُردُو&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;eng_name&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urdu&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;script&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urdu/ur_scripts.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;vocab&quot;</span><span class=w>   </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urdu/ur_words_ccset.json&quot;</span><span class=p>,</span><span class=w></span>
<span class=w>        </span><span class=nt>&quot;weight&quot;</span><span class=w>  </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;urdu/ur_101_model.pth&quot;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> The models from the external volume needs to be mounted at <code>/opt/text_to_speech_open_api/deployed_models/</code> inside the pod. The volume mounts are specified in <code>https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra</code> </p> <p><strong>Ngnix</strong>: A NGNIX router should be deployed and be publicly exposed as a load balancer service.It acts as a reverse-proxy for all traffic coming in. The ngnix conf file should be updated with proper location blocks to support TTS endpoints similar to the ASR implementation. Ngnix is a manual deployment by the infra team and used as a common component for all services. </p> <p><strong>Envoy</strong>: Here for TTS, the envoy acts as a load balancer service for redirecting traffic to the API pods at the backend.The envoy is responsible for handling all REST based requests to the API.</p> <p><strong>Model API server</strong>: The model API server for every language or cluster of languages is deployed as separate pods in the cluster. The language clusters and node accelerators can be configured in the file app_config.yaml. The volume paths can also be correctly configured in the deployment.yaml files and values.yaml files. These files post changes can be committed to the repo, <code>https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra/tree/cdac-deploy</code></p> <p>The deployment for envoy and API server language pods can be configured using Jenkins or can be triggered manually by running the below command in a bastion/window node of CDAC. All three components can be deployed at once. <code>python3 deploy.py --namespace &lt;kubernetes namespace&gt; --api-updated True --image-name gcr.io/ekstepspeechrecognition/text-to-speech-open-api --image-version &lt;latest image version&gt;</code></p> <p>With the successful deployment of components, the pods and services should get spawned for envoy, and language APIs.</p> <h3 id=api-for-cdac_1>API for CDAC:<a class=headerlink href=#api-for-cdac_1 title="Permanent link">&para;</a></h3> <p>The REST API endpoint can be accessible for POST requests <code>https://cdac.ulcacontrib.org/tts/v1/&lt;language_code&gt;</code></p> <p>The below figure shows how our pods are able to load the model files from the volume mounts and write back application logs to the volume.</p> <p><img alt=Screenshot src=../img/volume_mounts_in_cluster.png> Fig 3</p> <h2 id=contributing>Contributing<a class=headerlink href=#contributing title="Permanent link">&para;</a></h2> <p>Contributions are what make the open source community such an amazing place to be learn, inspire, and create. Any contributions you make are <strong>greatly appreciated</strong>.</p> <ol> <li>Fork the Project</li> <li>Create your Feature Branch (<code>git checkout -b feature/AmazingFeature</code>)</li> <li>Commit your Changes (<code>git commit -m 'Add some AmazingFeature'</code>)</li> <li>Push to the Branch (<code>git push origin feature/AmazingFeature</code>)</li> <li>Open a Pull Request</li> </ol> <h2 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h2> <p>Distributed under the [MIT] License. See <code>LICENSE</code> for more information.</p> <h2 id=git-repository>Git repository<a class=headerlink href=#git-repository title="Permanent link">&para;</a></h2> <p><a href=https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra.git>https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra.git</a></p> <h2 id=contact>Contact<a class=headerlink href=#contact title="Permanent link">&para;</a></h2> <p>Connect with community on <a href="https://gitter.im/Vakyansh/community?utm_source=share-link&utm_medium=link&utm_campaign=share-link">Gitter</a></p> <p>Project Link: <a href=https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra.git>https://github.com/Open-Speech-EkStep/text-to-speech-open-api-infra.git</a></p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../tts_model_api/ class="md-footer__link md-footer__link--prev" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Text To Speech Model API </div> </div> </a> <a href=../CONTRIBUTING/ class="md-footer__link md-footer__link--next" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Contributions </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2021 EkStep Foundation. All Rights Reserved. </div> <!--         Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a> --> Vakyansh </div> <!--        --> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.sections", "navigation.tabs"], "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}, "version": null}</script> <script src=../assets/javascripts/bundle.7865d441.min.js></script> </body> </html>